<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Local Widget Renderer</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; height: 120px; }
    iframe { width: 100%; height: 500px; border: 1px solid #ccc; margin-top: 20px; }
  </style>
</head>
<body>

<h1>Local Widget Renderer</h1>

<p><strong>1) Paste widget HTML:</strong></p>
<textarea id="htmlInput" placeholder="Paste contents of the widget HTML here..."></textarea>

<p><strong>2) Paste structuredContent JSON:</strong></p>
<textarea id="jsonInput" placeholder='Example: {"pizzaTopping":"pepperoni"}'></textarea>

<button id="renderBtn">Render Widget</button>

<h2>Rendered Widget:</h2>
<iframe id="outputFrame"></iframe>

<script>
function hydrateTemplate(template, data) {
  return template.replace(/{{\s*(\w+)\s*}}/g, (m, key) => {
    return key in data ? data[key] : m;
  });
}

document.getElementById("renderBtn").onclick = () => {
  const html = document.getElementById("htmlInput").value;
  const json = document.getElementById("jsonInput").value;

  let data = {};
  try {
    data = JSON.parse(json);
  } catch (e) {
    alert("Invalid JSON in structuredContent");
    return;
  }

  const hydrated = hydrateTemplate(html, data);
  const iframe = document.getElementById("outputFrame");
  iframe.srcdoc = hydrated;
};
</script>

</body>
</html>